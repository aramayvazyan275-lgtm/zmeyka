<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–º–µ–π–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000000;
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(138, 43, 226, 0.3) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(0, 191, 255, 0.25) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(75, 0, 130, 0.2) 0%, transparent 60%),
                linear-gradient(135deg, #000000 0%, #0a0a1a 25%, #1a0a2e 50%, #16213e 75%, #000000 100%);
            opacity: 1;
            animation: nebulaShift 20s ease-in-out infinite;
        }

        @keyframes nebulaShift {
            0%, 100% { 
                background: 
                    radial-gradient(ellipse at 20% 30%, rgba(138, 43, 226, 0.3) 0%, transparent 50%),
                    radial-gradient(ellipse at 80% 70%, rgba(0, 191, 255, 0.25) 0%, transparent 50%),
                    radial-gradient(ellipse at 50% 50%, rgba(75, 0, 130, 0.2) 0%, transparent 60%),
                    linear-gradient(135deg, #000000 0%, #0a0a1a 25%, #1a0a2e 50%, #16213e 75%, #000000 100%);
            }
            50% { 
                background: 
                    radial-gradient(ellipse at 30% 40%, rgba(138, 43, 226, 0.35) 0%, transparent 50%),
                    radial-gradient(ellipse at 70% 60%, rgba(0, 191, 255, 0.3) 0%, transparent 50%),
                    radial-gradient(ellipse at 50% 50%, rgba(75, 0, 130, 0.25) 0%, transparent 60%),
                    linear-gradient(135deg, #000000 0%, #0a0a1a 25%, #1a0a2e 50%, #16213e 75%, #000000 100%);
            }
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background-image: 
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 40%, white, transparent),
                radial-gradient(1px 1px at 30% 80%, white, transparent),
                radial-gradient(1px 1px at 10% 60%, white, transparent),
                radial-gradient(2px 2px at 40% 20%, white, transparent);
            background-size: 200% 200%;
            background-position: 0% 0%, 100% 0%, 50% 50%, 0% 100%, 100% 100%, 50% 0%, 0% 50%, 100% 50%;
            animation: starsMove 30s linear infinite;
            pointer-events: none;
            opacity: 0.8;
        }

        @keyframes starsMove {
            0% { background-position: 0% 0%, 100% 0%, 50% 50%, 0% 100%, 100% 100%, 50% 0%, 0% 50%, 100% 50%; }
            100% { background-position: 100% 100%, 0% 100%, 50% 50%, 100% 0%, 0% 0%, 50% 100%, 100% 50%, 0% 50%; }
        }

        .space-bodies {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .space-body {
            position: absolute;
            pointer-events: none;
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 1 - –§–∏–æ–ª–µ—Ç–æ–≤–∞—è */
        .planet-1 {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(138, 43, 226, 1) 0%,
                rgba(75, 0, 130, 0.9) 40%,
                rgba(25, 25, 112, 0.8) 100%);
            box-shadow: 
                0 0 50px rgba(138, 43, 226, 0.9),
                0 0 100px rgba(138, 43, 226, 0.5),
                inset -20px -20px 40px rgba(0, 0, 0, 0.5),
                inset 10px 10px 20px rgba(255, 255, 255, 0.2);
            animation: planetFloat1 50s infinite ease-in-out;
            top: 15%;
            left: -150px;
        }

        @keyframes planetFloat1 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            25% { transform: translateX(calc(100vw + 150px)) translateY(-50px) rotate(90deg); }
            50% { transform: translateX(calc(100vw + 150px)) translateY(50px) rotate(180deg); }
            75% { transform: translateX(0) translateY(30px) rotate(270deg); }
            100% { transform: translateX(0) translateY(0) rotate(360deg); }
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 2 - –ì–æ–ª—É–±–∞—è */
        .planet-2 {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle at 25% 25%, 
                rgba(0, 191, 255, 1) 0%,
                rgba(0, 100, 200, 0.9) 50%,
                rgba(0, 50, 100, 0.8) 100%);
            box-shadow: 
                0 0 40px rgba(0, 191, 255, 0.9),
                0 0 80px rgba(0, 191, 255, 0.5),
                inset -15px -15px 30px rgba(0, 0, 0, 0.5),
                inset 8px 8px 15px rgba(255, 255, 255, 0.2);
            animation: planetFloat2 60s infinite ease-in-out;
            top: 60%;
            right: -100px;
            animation-delay: 3s;
        }

        @keyframes planetFloat2 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            33% { transform: translateX(calc(-100vw - 100px)) translateY(-80px) rotate(120deg); }
            66% { transform: translateX(calc(-100vw - 100px)) translateY(80px) rotate(240deg); }
            100% { transform: translateX(0) translateY(0) rotate(360deg); }
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 3 - –û—Ä–∞–Ω–∂–µ–≤–∞—è */
        .planet-3 {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            background: radial-gradient(circle at 35% 35%, 
                rgba(255, 140, 0, 1) 0%,
                rgba(255, 69, 0, 0.9) 40%,
                rgba(139, 69, 19, 0.8) 100%);
            box-shadow: 
                0 0 45px rgba(255, 140, 0, 0.9),
                0 0 90px rgba(255, 140, 0, 0.5),
                inset -18px -18px 35px rgba(0, 0, 0, 0.5),
                inset 9px 9px 18px rgba(255, 255, 255, 0.2);
            animation: planetFloat3 35s infinite ease-in-out;
            top: 40%;
            left: -120px;
            animation-delay: 5s;
        }

        @keyframes planetFloat3 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            20% { transform: translateX(calc(100vw + 120px)) translateY(-100px) rotate(72deg); }
            40% { transform: translateX(calc(100vw + 120px)) translateY(100px) rotate(144deg); }
            60% { transform: translateX(calc(100vw + 120px)) translateY(-50px) rotate(216deg); }
            80% { transform: translateX(0) translateY(50px) rotate(288deg); }
            100% { transform: translateX(0) translateY(0) rotate(360deg); }
        }

        /* –ê—Å—Ç–µ—Ä–æ–∏–¥ 1 */
        .asteroid-1 {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, 
                rgba(150, 150, 150, 0.9) 0%,
                rgba(100, 100, 100, 0.8) 100%);
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            box-shadow: 
                0 0 25px rgba(200, 200, 200, 0.7),
                0 0 50px rgba(150, 150, 150, 0.4),
                inset -5px -5px 10px rgba(0, 0, 0, 0.6);
            animation: asteroidFloat1 40s infinite linear;
            top: 25%;
            left: -50px;
        }

        @keyframes asteroidFloat1 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            100% { transform: translateX(calc(100vw + 50px)) translateY(200px) rotate(720deg); }
        }

        /* –ê—Å—Ç–µ—Ä–æ–∏–¥ 2 */
        .asteroid-2 {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, 
                rgba(130, 130, 130, 0.9) 0%,
                rgba(80, 80, 80, 0.8) 100%);
            border-radius: 40% 60% 60% 40% / 40% 40% 60% 60%;
            box-shadow: 
                0 0 20px rgba(180, 180, 180, 0.7),
                0 0 40px rgba(130, 130, 130, 0.4),
                inset -4px -4px 8px rgba(0, 0, 0, 0.6);
            animation: asteroidFloat2 18s infinite linear;
            top: 70%;
            right: -45px;
            animation-delay: 2s;
        }

        @keyframes asteroidFloat2 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            100% { transform: translateX(calc(-100vw - 45px)) translateY(-150px) rotate(-720deg); }
        }

        /* –ê—Å—Ç–µ—Ä–æ–∏–¥ 3 */
        .asteroid-3 {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, 
                rgba(140, 140, 140, 0.9) 0%,
                rgba(90, 90, 90, 0.8) 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 
                0 0 18px rgba(170, 170, 170, 0.7),
                0 0 35px rgba(140, 140, 140, 0.4),
                inset -3px -3px 6px rgba(0, 0, 0, 0.6);
            animation: asteroidFloat3 22s infinite linear;
            top: 50%;
            left: -40px;
            animation-delay: 4s;
        }

        @keyframes asteroidFloat3 {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            100% { transform: translateX(calc(100vw + 40px)) translateY(-100px) rotate(540deg); }
        }

        /* –ö–æ–º–µ—Ç–∞ */
        .comet {
            width: 80px;
            height: 80px;
            position: absolute;
            top: 10%;
            left: -80px;
            animation: cometFly 15s infinite linear;
            animation-delay: 1s;
        }

        .comet::before {
            content: '';
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: radial-gradient(circle, 
                rgba(255, 255, 255, 1) 0%,
                rgba(0, 191, 255, 0.9) 40%,
                rgba(0, 100, 200, 0.7) 70%,
                transparent 100%);
            box-shadow: 
                0 0 30px rgba(0, 191, 255, 1),
                0 0 60px rgba(0, 191, 255, 0.6);
            top: 50%;
            left: 0;
            transform: translateY(-50%);
        }

        .comet::after {
            content: '';
            position: absolute;
            width: 250px;
            height: 4px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(0, 191, 255, 0.8) 20%,
                rgba(255, 255, 255, 0.6) 40%,
                rgba(0, 191, 255, 0.4) 60%,
                transparent 100%);
            top: 50%;
            left: 30px;
            transform: translateY(-50%);
            box-shadow: 
                0 0 20px rgba(0, 191, 255, 0.8),
                0 0 40px rgba(0, 191, 255, 0.4);
        }

        @keyframes cometFly {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            100% { transform: translateX(calc(100vw + 200px)) translateY(calc(100vh + 200px)) rotate(180deg); }
        }

        /* –ú–∞–ª–µ–Ω—å–∫–∞—è –ø–ª–∞–Ω–µ—Ç–∞ */
        .planet-small {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(255, 0, 255, 1) 0%,
                rgba(138, 43, 226, 0.9) 50%,
                rgba(75, 0, 130, 0.8) 100%);
            box-shadow: 
                0 0 35px rgba(255, 0, 255, 0.9),
                0 0 70px rgba(255, 0, 255, 0.5),
                inset -10px -10px 20px rgba(0, 0, 0, 0.5),
                inset 5px 5px 10px rgba(255, 255, 255, 0.2);
            animation: planetSmallFloat 56s infinite ease-in-out;
            top: 80%;
            right: -80px;
            animation-delay: 7s;
        }

        @keyframes planetSmallFloat {
            0% { transform: translateX(0) translateY(0) rotate(0deg); }
            50% { transform: translateX(calc(-100vw - 80px)) translateY(-150px) rotate(180deg); }
            100% { transform: translateX(0) translateY(0) rotate(360deg); }
        }

        /* –ü—É–ª—å—Å–∏—Ä—É—é—â–∏–µ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Ç–µ–ª–∞ */
        @keyframes planetPulse {
            0%, 100% { 
                transform: scale(1); 
                opacity: 0.85; 
            }
            50% { 
                transform: scale(1.15); 
                opacity: 1; 
            }
        }

        @keyframes ringRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 1 - –§–∏–æ–ª–µ—Ç–æ–≤–∞—è —Å –∫–æ–ª—å—Ü–∞–º–∏ */
        .pulsing-planet-1 {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(138, 43, 226, 1) 0%,
                rgba(75, 0, 130, 0.9) 50%,
                rgba(25, 25, 112, 0.8) 100%);
            box-shadow: 
                0 0 40px rgba(138, 43, 226, 1),
                0 0 80px rgba(138, 43, 226, 0.6),
                inset -15px -15px 30px rgba(0, 0, 0, 0.5),
                inset 8px 8px 15px rgba(255, 255, 255, 0.3);
            position: absolute;
            top: 18%;
            left: 12%;
            animation: planetPulse 4s ease-in-out infinite;
        }

        .pulsing-planet-1::before {
            content: '';
            position: absolute;
            width: 140px;
            height: 8px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(138, 43, 226, 0.6) 20%,
                rgba(255, 255, 255, 0.4) 50%,
                rgba(138, 43, 226, 0.6) 80%,
                transparent 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(45deg);
            box-shadow: 
                0 0 20px rgba(138, 43, 226, 0.5),
                inset 0 0 10px rgba(255, 255, 255, 0.2);
            animation: ringRotate 20s linear infinite;
        }

        .pulsing-planet-1::after {
            content: '';
            position: absolute;
            width: 160px;
            height: 6px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(138, 43, 226, 0.4) 20%,
                rgba(255, 255, 255, 0.3) 50%,
                rgba(138, 43, 226, 0.4) 80%,
                transparent 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.4);
            animation: ringRotate 25s linear infinite reverse;
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 2 - –ì–æ–ª—É–±–∞—è —Å –∫–æ–ª—å—Ü–∞–º–∏ */
        .pulsing-planet-2 {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle at 25% 25%, 
                rgba(0, 191, 255, 1) 0%,
                rgba(0, 100, 200, 0.9) 50%,
                rgba(0, 50, 100, 0.8) 100%);
            box-shadow: 
                0 0 35px rgba(0, 191, 255, 1),
                0 0 70px rgba(0, 191, 255, 0.6),
                inset -12px -12px 25px rgba(0, 0, 0, 0.5),
                inset 6px 6px 12px rgba(255, 255, 255, 0.3);
            position: absolute;
            top: 72%;
            right: 18%;
            animation: planetPulse 5s ease-in-out infinite;
            animation-delay: 1s;
        }

        .pulsing-planet-2::before {
            content: '';
            position: absolute;
            width: 130px;
            height: 7px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(0, 191, 255, 0.6) 20%,
                rgba(255, 255, 255, 0.4) 50%,
                rgba(0, 191, 255, 0.6) 80%,
                transparent 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(30deg);
            box-shadow: 
                0 0 18px rgba(0, 191, 255, 0.5),
                inset 0 0 8px rgba(255, 255, 255, 0.2);
            animation: ringRotate 18s linear infinite;
        }

        .pulsing-planet-2::after {
            content: '';
            position: absolute;
            width: 150px;
            height: 5px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(0, 191, 255, 0.4) 20%,
                rgba(255, 255, 255, 0.3) 50%,
                rgba(0, 191, 255, 0.4) 80%,
                transparent 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            box-shadow: 0 0 12px rgba(0, 191, 255, 0.4);
            animation: ringRotate 22s linear infinite reverse;
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 3 - –û—Ä–∞–Ω–∂–µ–≤–∞—è –±–µ–∑ –∫–æ–ª–µ—Ü */
        .pulsing-planet-3 {
            width: 75px;
            height: 75px;
            border-radius: 50%;
            background: radial-gradient(circle at 35% 35%, 
                rgba(255, 140, 0, 1) 0%,
                rgba(255, 69, 0, 0.9) 40%,
                rgba(139, 69, 19, 0.8) 100%);
            box-shadow: 
                0 0 40px rgba(255, 140, 0, 1),
                0 0 80px rgba(255, 140, 0, 0.6),
                inset -12px -12px 25px rgba(0, 0, 0, 0.5),
                inset 6px 6px 12px rgba(255, 255, 255, 0.3);
            position: absolute;
            top: 55%;
            left: 8%;
            animation: planetPulse 4.5s ease-in-out infinite;
            animation-delay: 0.5s;
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 4 - –†–æ–∑–æ–≤–∞—è —Å –∫–æ–ª—å—Ü–∞–º–∏ */
        .pulsing-planet-4 {
            width: 85px;
            height: 85px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(255, 0, 255, 1) 0%,
                rgba(138, 43, 226, 0.9) 50%,
                rgba(75, 0, 130, 0.8) 100%);
            box-shadow: 
                0 0 38px rgba(255, 0, 255, 1),
                0 0 75px rgba(255, 0, 255, 0.6),
                inset -14px -14px 28px rgba(0, 0, 0, 0.5),
                inset 7px 7px 14px rgba(255, 255, 255, 0.3);
            position: absolute;
            top: 35%;
            right: 15%;
            animation: planetPulse 5.5s ease-in-out infinite;
            animation-delay: 1.5s;
        }

        .pulsing-planet-4::before {
            content: '';
            position: absolute;
            width: 135px;
            height: 7px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(255, 0, 255, 0.6) 20%,
                rgba(255, 255, 255, 0.4) 50%,
                rgba(255, 0, 255, 0.6) 80%,
                transparent 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(60deg);
            box-shadow: 
                0 0 20px rgba(255, 0, 255, 0.5),
                inset 0 0 10px rgba(255, 255, 255, 0.2);
            animation: ringRotate 24s linear infinite;
        }

        .pulsing-planet-4::after {
            content: '';
            position: absolute;
            width: 155px;
            height: 5px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(255, 0, 255, 0.4) 20%,
                rgba(255, 255, 255, 0.3) 50%,
                rgba(255, 0, 255, 0.4) 80%,
                transparent 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-60deg);
            box-shadow: 0 0 15px rgba(255, 0, 255, 0.4);
            animation: ringRotate 28s linear infinite reverse;
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ 5 - –ó–æ–ª–æ—Ç–∞—è –±–µ–∑ –∫–æ–ª–µ—Ü */
        .pulsing-planet-5 {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, 
                rgba(255, 215, 0, 1) 0%,
                rgba(255, 165, 0, 0.9) 50%,
                rgba(255, 140, 0, 0.8) 100%);
            box-shadow: 
                0 0 35px rgba(255, 215, 0, 1),
                0 0 70px rgba(255, 215, 0, 0.6),
                inset -10px -10px 20px rgba(0, 0, 0, 0.5),
                inset 5px 5px 10px rgba(255, 255, 255, 0.3);
            position: absolute;
            top: 88%;
            left: 25%;
            animation: planetPulse 4.2s ease-in-out infinite;
            animation-delay: 0.8s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }

        h1 {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) perspective(500px) rotateX(5deg);
            color: #00ffff;
            font-size: 2.5em;
            font-weight: 900;
            text-shadow: 
                0 0 10px rgba(0, 255, 255, 0.8),
                0 0 20px rgba(0, 255, 255, 0.6),
                0 0 30px rgba(0, 255, 255, 0.4),
                0 0 40px rgba(138, 43, 226, 0.5),
                0 4px 8px rgba(0, 0, 0, 0.8),
                0 8px 16px rgba(0, 0, 0, 0.6);
            z-index: 10;
            animation: fadeIn 1s ease-out, titleGlow 3s ease-in-out infinite;
            background: linear-gradient(135deg, 
                rgba(0, 191, 255, 0.15) 0%, 
                rgba(138, 43, 226, 0.2) 50%, 
                rgba(0, 191, 255, 0.15) 100%);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 2px solid rgba(0, 255, 255, 0.4);
            border-top: 2px solid rgba(255, 255, 255, 0.6);
            border-bottom: 2px solid rgba(0, 0, 0, 0.5);
            padding: 15px 30px;
            border-radius: 20px;
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.4),
                0 0 40px rgba(138, 43, 226, 0.3),
                0 10px 30px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3);
            transform-style: preserve-3d;
            letter-spacing: 2px;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        h1.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        @keyframes titleGlow {
            0%, 100% { 
                text-shadow: 
                    0 0 10px rgba(0, 255, 255, 0.8),
                    0 0 20px rgba(0, 255, 255, 0.6),
                    0 0 30px rgba(0, 255, 255, 0.4),
                    0 0 40px rgba(138, 43, 226, 0.5),
                    0 4px 8px rgba(0, 0, 0, 0.8);
            }
            50% { 
                text-shadow: 
                    0 0 15px rgba(0, 255, 255, 1),
                    0 0 30px rgba(0, 255, 255, 0.8),
                    0 0 45px rgba(0, 255, 255, 0.6),
                    0 0 60px rgba(138, 43, 226, 0.7),
                    0 4px 8px rgba(0, 0, 0, 0.8);
            }
        }

        .score {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%) perspective(500px) rotateX(5deg);
            font-size: 1.5em;
            color: #ff00ff;
            font-weight: 800;
            text-shadow: 
                0 0 10px rgba(255, 0, 255, 0.8),
                0 0 20px rgba(255, 0, 255, 0.6),
                0 0 30px rgba(255, 0, 255, 0.4),
                0 2px 4px rgba(0, 0, 0, 0.8);
            z-index: 10;
            background: linear-gradient(135deg, 
                rgba(255, 0, 255, 0.15) 0%, 
                rgba(138, 43, 226, 0.2) 50%, 
                rgba(0, 191, 255, 0.15) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 0, 255, 0.4);
            border-top: 2px solid rgba(255, 255, 255, 0.5);
            border-bottom: 2px solid rgba(0, 0, 0, 0.5);
            padding: 12px 24px;
            border-radius: 16px;
            box-shadow: 
                0 0 20px rgba(255, 0, 255, 0.4),
                0 0 40px rgba(138, 43, 226, 0.3),
                0 10px 30px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3);
            transform-style: preserve-3d;
            letter-spacing: 1px;
            animation: scoreGlow 2s ease-in-out infinite;
        }

        @keyframes scoreGlow {
            0%, 100% { 
                text-shadow: 
                    0 0 10px rgba(255, 0, 255, 0.8),
                    0 0 20px rgba(255, 0, 255, 0.6),
                    0 0 30px rgba(255, 0, 255, 0.4);
            }
            50% { 
                text-shadow: 
                    0 0 15px rgba(255, 0, 255, 1),
                    0 0 30px rgba(255, 0, 255, 0.8),
                    0 0 45px rgba(255, 0, 255, 0.6);
            }
        }

        canvas {
            width: 100vw;
            height: 100vh;
            display: block;
            border: none;
            position: relative;
            z-index: 2;
            background: transparent;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            z-index: 10;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) perspective(500px) rotateX(5deg);
            background: linear-gradient(135deg, 
                rgba(0, 191, 255, 0.15) 0%, 
                rgba(138, 43, 226, 0.2) 50%, 
                rgba(0, 191, 255, 0.15) 100%);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 2px solid rgba(0, 255, 255, 0.4);
            border-top: 2px solid rgba(255, 255, 255, 0.6);
            border-bottom: 2px solid rgba(0, 0, 0, 0.5);
            color: #00ffff;
            padding: 40px 50px;
            border-radius: 20px;
            display: none;
            text-align: center;
            z-index: 100;
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.4),
                0 0 40px rgba(138, 43, 226, 0.3),
                0 20px 50px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3);
            transform-style: preserve-3d;
            animation: slideUp 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275), gameOverGlow 3s ease-in-out infinite;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translate(-50%, -40%) perspective(500px) rotateX(5deg);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) perspective(500px) rotateX(5deg);
            }
        }

        @keyframes gameOverGlow {
            0%, 100% { 
                box-shadow: 
                    0 0 20px rgba(0, 255, 255, 0.4),
                    0 0 40px rgba(138, 43, 226, 0.3),
                    0 20px 50px rgba(0, 0, 0, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.3);
            }
            50% { 
                box-shadow: 
                    0 0 30px rgba(0, 255, 255, 0.6),
                    0 0 60px rgba(138, 43, 226, 0.5),
                    0 20px 50px rgba(0, 0, 0, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3),
                    inset 0 -1px 0 rgba(0, 0, 0, 0.3);
            }
        }

        .game-over.show {
            display: block;
        }

        .game-over h2 {
            margin-bottom: 20px;
            font-size: 2.5em;
            font-weight: 900;
            color: #00ffff;
            text-shadow: 
                0 0 10px rgba(0, 255, 255, 0.8),
                0 0 20px rgba(0, 255, 255, 0.6),
                0 0 30px rgba(0, 255, 255, 0.4),
                0 0 40px rgba(138, 43, 226, 0.5),
                0 4px 8px rgba(0, 0, 0, 0.8),
                0 8px 16px rgba(0, 0, 0, 0.6);
            letter-spacing: 2px;
            animation: titleGlow 3s ease-in-out infinite;
        }

        .game-over p {
            font-size: 1.3em;
            color: #00ffff;
            margin-bottom: 30px;
            text-shadow: 
                0 0 8px rgba(0, 255, 255, 0.6),
                0 0 16px rgba(0, 255, 255, 0.4),
                0 2px 4px rgba(0, 0, 0, 0.8);
            font-weight: 700;
            letter-spacing: 1px;
        }

        .game-over #finalScore {
            color: #ff00ff;
            text-shadow: 
                0 0 10px rgba(255, 0, 255, 0.8),
                0 0 20px rgba(255, 0, 255, 0.6),
                0 0 30px rgba(255, 0, 255, 0.4);
            font-weight: 900;
        }

        .game-over button {
            background: linear-gradient(135deg, 
                rgba(0, 191, 255, 0.2) 0%, 
                rgba(138, 43, 226, 0.25) 50%, 
                rgba(0, 191, 255, 0.2) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(0, 255, 255, 0.4);
            border-top: 2px solid rgba(255, 255, 255, 0.5);
            border-bottom: 2px solid rgba(0, 0, 0, 0.5);
            color: #00ffff;
            padding: 15px 35px;
            font-size: 1.2em;
            font-weight: 700;
            border-radius: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.25s;
            text-shadow: 
                0 0 8px rgba(0, 255, 255, 0.6),
                0 0 16px rgba(0, 255, 255, 0.4);
            letter-spacing: 1px;
            box-shadow: 
                0 0 15px rgba(0, 255, 255, 0.3),
                0 0 30px rgba(138, 43, 226, 0.2),
                0 6px 20px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3);
        }

        .game-over button:hover {
            background: linear-gradient(135deg, 
                rgba(0, 191, 255, 0.3) 0%, 
                rgba(138, 43, 226, 0.35) 50%, 
                rgba(0, 191, 255, 0.3) 100%);
            transform: translateY(-3px);
            box-shadow: 
                0 0 25px rgba(0, 255, 255, 0.5),
                0 0 50px rgba(138, 43, 226, 0.4),
                0 8px 25px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.4),
                inset 0 -1px 0 rgba(0, 0, 0, 0.4);
            text-shadow: 
                0 0 12px rgba(0, 255, 255, 0.8),
                0 0 24px rgba(0, 255, 255, 0.6);
        }

        /* –°–µ–Ω—Å–æ—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ - –∫–Ω–æ–ø–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .touch-controls {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
            z-index: 100;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .touch-controls {
                display: block;
            }
            
            .controls {
                display: none; /* –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø—Ä–æ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
            }
        }

        .d-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 5px;
            width: 150px;
            height: 150px;
            margin: 0 auto;
            pointer-events: all;
        }

        .d-pad-button {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid rgba(255, 255, 255, 0.5);
            border-bottom: 2px solid rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            cursor: pointer;
            user-select: none;
            -webkit-user-select: none;
            touch-action: none;
            transition: all 0.1s;
            box-shadow: 
                0 0 15px rgba(0, 255, 255, 0.3),
                0 4px 15px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .d-pad-button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 
                0 0 20px rgba(0, 255, 255, 0.5),
                0 2px 10px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .d-pad-button.up {
            grid-column: 2;
            grid-row: 1;
        }

        .d-pad-button.down {
            grid-column: 2;
            grid-row: 3;
        }

        .d-pad-button.left {
            grid-column: 1;
            grid-row: 2;
        }

        .d-pad-button.right {
            grid-column: 3;
            grid-row: 2;
        }

        .d-pad-button.center {
            grid-column: 2;
            grid-row: 2;
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="space-bodies">
        <!-- –ü—É–ª—å—Å–∏—Ä—É—é—â–∏–µ –∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Ç–µ–ª–∞ -->
        <div class="space-body pulsing-planet-1"></div>
        <div class="space-body pulsing-planet-2"></div>
        <div class="space-body pulsing-planet-3"></div>
        <div class="space-body pulsing-planet-4"></div>
        <div class="space-body pulsing-planet-5"></div>
    </div>
    <div class="game-container">
        <h1>üöÄ –ó–º–µ–π–∫–∞</h1>
        <div class="score">–°—á—ë—Ç: <span id="score">0</span></div>
        <canvas id="gameCanvas"></canvas>
        <div class="controls">
            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–µ–ª–∫–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</p>
        </div>
    </div>

    <div class="game-over" id="gameOver">
        <h2>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
        <p>–í–∞—à —Å—á—ë—Ç: <span id="finalScore">0</span></p>
        <button onclick="restartGame()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>

    <!-- –°–µ–Ω—Å–æ—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
    <div class="touch-controls">
        <div class="d-pad">
            <div class="d-pad-button center"></div>
            <div class="d-pad-button up" data-direction="up">‚ñ≤</div>
            <div class="d-pad-button left" data-direction="left">‚óÑ</div>
            <div class="d-pad-button right" data-direction="right">‚ñ∫</div>
            <div class="d-pad-button down" data-direction="down">‚ñº</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const gameOverElement = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');

        const gridSize = 20;
        let tileCountX, tileCountY;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ canvas
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            tileCountX = Math.floor(canvas.width / gridSize);
            tileCountY = Math.floor(canvas.height / gridSize);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ canvas
        resizeCanvas();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => {
            resizeCanvas();
        });

        let snake = [
            {x: Math.floor(tileCountX / 2), y: Math.floor(tileCountY / 2)}
        ];
        let food = {};
        let bombs = []; // –ú–∞—Å—Å–∏–≤ –±–æ–º–±: {x, y, timer}
        let dx = 0;
        let dy = 0;
        let score = 0;
        let gameRunning = true;
        let bombSpawnInterval = null;
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–≥—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—á–µ—Ç–∞
        function getGameSpeed() {
            // –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å 100–º—Å, —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –¥–æ –º–∏–Ω–∏–º—É–º–∞ 40–º—Å
            const baseSpeed = 100;
            const minSpeed = 40;
            const speedReduction = Math.min(score * 2, 60); // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ 60–º—Å
            return Math.max(baseSpeed - speedReduction, minSpeed);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è –±–æ–º–± –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—á–µ—Ç–∞
        function getBombSpawnInterval() {
            // –ë–∞–∑–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞ 3-5 —Å–µ–∫—É–Ω–¥, —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –¥–æ 1-2 —Å–µ–∫—É–Ω–¥
            const baseMin = 3000;
            const baseMax = 5000;
            const minInterval = 1000;
            const maxInterval = 2000;
            const reduction = Math.min(score * 100, 2000); // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ 2 —Å–µ–∫—É–Ω–¥—ã
            return {
                min: Math.max(baseMin - reduction, minInterval),
                max: Math.max(baseMax - reduction, maxInterval)
            };
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –±–æ–º–±—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—á–µ—Ç–∞
        function getBombLifetime() {
            // –ë–∞–∑–æ–≤–∞—è –∂–∏–∑–Ω—å 5 —Å–µ–∫—É–Ω–¥, —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –¥–æ 2.5 —Å–µ–∫—É–Ω–¥
            const baseLifetime = 5000;
            const minLifetime = 2500;
            const reduction = Math.min(score * 50, 2500); // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ 2.5 —Å–µ–∫—É–Ω–¥—ã
            return Math.max(baseLifetime - reduction, minLifetime);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–º–±
        function updateBombSpawnInterval() {
            if (bombSpawnInterval) {
                clearInterval(bombSpawnInterval);
            }
            const interval = getBombSpawnInterval();
            const delay = interval.min + Math.random() * (interval.max - interval.min);
            bombSpawnInterval = setInterval(() => {
                spawnBomb();
            }, delay);
        }

        function randomFood() {
            let newFood;
            do {
                newFood = {
                    x: Math.floor(Math.random() * tileCountX),
                    y: Math.floor(Math.random() * tileCountY)
                };
            } while (snake.some(segment => segment.x === newFood.x && segment.y === newFood.y));
            food = newFood;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç –∑–º–µ–π–∫–∏
        function isFarFromSnake(x, y, minDistance = 3) {
            for (let segment of snake) {
                const distance = Math.abs(segment.x - x) + Math.abs(segment.y - y);
                if (distance < minDistance) {
                    return false;
                }
            }
            return true;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–æ–º–±—ã –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç –∑–º–µ–π–∫–∏
        function spawnBomb() {
            if (!gameRunning) return;
            
            let newBomb;
            let attempts = 0;
            const maxAttempts = 50;
            
            do {
                newBomb = {
                    x: Math.floor(Math.random() * tileCountX),
                    y: Math.floor(Math.random() * tileCountY)
                };
                attempts++;
            } while (
                attempts < maxAttempts && 
                (!isFarFromSnake(newBomb.x, newBomb.y) || 
                 (newBomb.x === food.x && newBomb.y === food.y) ||
                 bombs.some(bomb => bomb.x === newBomb.x && bomb.y === newBomb.y))
            );
            
            if (attempts < maxAttempts) {
                const bomb = {
                    x: newBomb.x,
                    y: newBomb.y,
                    spawnTime: Date.now(),
                    lifetime: getBombLifetime()
                };
                bombs.push(bomb);
                
                // –£–¥–∞–ª–µ–Ω–∏–µ –±–æ–º–±—ã —á–µ—Ä–µ–∑ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
                setTimeout(() => {
                    const index = bombs.findIndex(b => b.x === bomb.x && b.y === bomb.y && b.spawnTime === bomb.spawnTime);
                    if (index !== -1) {
                        bombs.splice(index, 1);
                    }
                }, bomb.lifetime);
            }
        }

        function drawGame() {
            clearCanvas();
            drawSnake();
            drawFood();
            drawBombs();
        }

        function clearCanvas() {
            // –û—á–∏—â–∞–µ–º canvas –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º, —á—Ç–æ–±—ã –∫–æ—Å–º–∏—á–µ—Å–∫–∏–µ —Ç–µ–ª–∞ –±—ã–ª–∏ –≤–∏–¥–Ω—ã
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –¢–æ–ª—å–∫–æ –ª–µ–≥–∫–∏–µ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã (–ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ)
            const nebula1 = ctx.createRadialGradient(canvas.width * 0.2, canvas.height * 0.3, 0, canvas.width * 0.2, canvas.height * 0.3, canvas.width * 0.5);
            nebula1.addColorStop(0, 'rgba(138, 43, 226, 0.1)');
            nebula1.addColorStop(1, 'transparent');
            ctx.fillStyle = nebula1;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const nebula2 = ctx.createRadialGradient(canvas.width * 0.8, canvas.height * 0.7, 0, canvas.width * 0.8, canvas.height * 0.7, canvas.width * 0.4);
            nebula2.addColorStop(0, 'rgba(0, 191, 255, 0.08)');
            nebula2.addColorStop(1, 'transparent');
            ctx.fillStyle = nebula2;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –ó–≤–µ–∑–¥—ã –Ω–∞ canvas (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫ —Ñ–æ–Ω—É)
            const time = Date.now() / 1000;
            for (let i = 0; i < 50; i++) {
                const x = (Math.sin(i * 137.5) * canvas.width * 0.5 + canvas.width * 0.5 + time * 10) % canvas.width;
                const y = (Math.cos(i * 137.5) * canvas.height * 0.5 + canvas.height * 0.5 + time * 5) % canvas.height;
                const brightness = (Math.sin(time * 2 + i) + 1) / 2;
                ctx.fillStyle = `rgba(255, 255, 255, ${brightness * 0.6})`;
                ctx.beginPath();
                ctx.arc(x, y, 1, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function drawSnake() {
            snake.forEach((segment, index) => {
                const x = segment.x * gridSize;
                const y = segment.y * gridSize;
                const size = gridSize - 2;
                const centerX = x + size / 2;
                const centerY = y + size / 2;
                const time = Date.now() / 100;
                
                if (index === 0) {
                    // 3D –≥–æ–ª–æ–≤–∞ –∑–º–µ–π–∫–∏ –≤ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ
                    const radius = size / 2 - 1;
                    const glowIntensity = (Math.sin(time) + 1) / 2 * 0.3 + 0.7;
                    
                    // –í–Ω–µ—à–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ (–Ω–µ–æ–Ω–æ–≤–æ–µ)
                    ctx.shadowColor = 'rgba(0, 255, 255, 0.8)';
                    ctx.shadowBlur = 15 * glowIntensity;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = 0;
                    
                    // –û—Å–Ω–æ–≤–Ω–æ–π 3D –≥—Ä–∞–¥–∏–µ–Ω—Ç (—Ü–∏–ª–∏–Ω–¥—Ä)
                    const headGradient = ctx.createRadialGradient(
                        centerX - 2, centerY - 2, 0,
                        centerX, centerY, radius
                    );
                    headGradient.addColorStop(0, `rgba(0, 255, 255, ${0.9 * glowIntensity})`);
                    headGradient.addColorStop(0.3, `rgba(0, 191, 255, ${0.8 * glowIntensity})`);
                    headGradient.addColorStop(0.6, `rgba(138, 43, 226, ${0.7 * glowIntensity})`);
                    headGradient.addColorStop(1, `rgba(75, 0, 130, ${0.6 * glowIntensity})`);
                    ctx.fillStyle = headGradient;
                    
                    // –†–∏—Å—É–µ–º 3D —Å—Ñ–µ—Ä—É
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // –í–µ—Ä—Ö–Ω–∏–π –±–ª–∏–∫ –¥–ª—è 3D —ç—Ñ—Ñ–µ–∫—Ç–∞
                    const highlightGradient = ctx.createRadialGradient(
                        centerX - radius * 0.3, centerY - radius * 0.3, 0,
                        centerX - radius * 0.3, centerY - radius * 0.3, radius * 0.6
                    );
                    highlightGradient.addColorStop(0, 'rgba(255, 255, 255, 0.8)');
                    highlightGradient.addColorStop(1, 'rgba(0, 255, 255, 0)');
                    ctx.fillStyle = highlightGradient;
                    ctx.beginPath();
                    ctx.arc(centerX - radius * 0.3, centerY - radius * 0.3, radius * 0.6, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // –ì—Ä–∞–Ω–∏—Ü–∞ —Å –Ω–µ–æ–Ω–æ–≤—ã–º —Å–≤–µ—á–µ–Ω–∏–µ–º
                    ctx.strokeStyle = `rgba(0, 255, 255, ${0.9 * glowIntensity})`;
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                    ctx.stroke();
                    
                    ctx.shadowBlur = 0;
                    
                    // –ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –≥–ª–∞–∑–∞
                    const eyeSize = 3;
                    const eyeOffset = 5;
                    const eyeGlow = 'rgba(255, 255, 255, 0.9)';
                    
                    ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';
                    ctx.shadowBlur = 5;
                    
                    if (dx === 1) { // –î–≤–∏–∂–µ–Ω–∏–µ –≤–ø—Ä–∞–≤–æ
                        ctx.fillStyle = eyeGlow;
                        ctx.beginPath();
                        ctx.arc(x + size - eyeOffset, y + eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.beginPath();
                        ctx.arc(x + size - eyeOffset, y + size - eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                    } else if (dx === -1) { // –î–≤–∏–∂–µ–Ω–∏–µ –≤–ª–µ–≤–æ
                        ctx.beginPath();
                        ctx.arc(x + eyeOffset, y + eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.beginPath();
                        ctx.arc(x + eyeOffset, y + size - eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                    } else if (dy === -1) { // –î–≤–∏–∂–µ–Ω–∏–µ –≤–≤–µ—Ä—Ö
                        ctx.beginPath();
                        ctx.arc(x + eyeOffset, y + eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.beginPath();
                        ctx.arc(x + size - eyeOffset, y + eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                    } else if (dy === 1) { // –î–≤–∏–∂–µ–Ω–∏–µ –≤–Ω–∏–∑
                        ctx.beginPath();
                        ctx.arc(x + eyeOffset, y + size - eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.beginPath();
                        ctx.arc(x + size - eyeOffset, y + size - eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                    } else { // –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è
                        ctx.beginPath();
                        ctx.arc(x + eyeOffset, y + eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.beginPath();
                        ctx.arc(x + size - eyeOffset, y + eyeOffset, eyeSize, 0, Math.PI * 2);
                        ctx.fill();
                    }
                    
                    ctx.shadowBlur = 0;
                } else {
                    // 3D —Ç–µ–ª–æ –∑–º–µ–π–∫–∏ –≤ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–º —Å—Ç–∏–ª–µ
                    const radius = size / 2 - 1;
                    const intensity = 1 - (index / snake.length) * 0.3;
                    const alpha = 0.7 * intensity;
                    const bodyGlow = (Math.sin(time + index) + 1) / 2 * 0.2 + 0.6;
                    
                    // –í–Ω–µ—à–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ
                    ctx.shadowColor = `rgba(138, 43, 226, ${0.6 * bodyGlow})`;
                    ctx.shadowBlur = 10 * bodyGlow;
                    
                    // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Ç–µ–ª–∞ (–æ—Ç –≥–æ–ª—É–±–æ–≥–æ –∫ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–º—É)
                    const bodyGradient = ctx.createRadialGradient(
                        centerX - 1, centerY - 1, 0,
                        centerX, centerY, radius
                    );
                    bodyGradient.addColorStop(0, `rgba(0, 191, 255, ${alpha * bodyGlow})`);
                    bodyGradient.addColorStop(0.5, `rgba(138, 43, 226, ${alpha * bodyGlow * 0.8})`);
                    bodyGradient.addColorStop(1, `rgba(75, 0, 130, ${alpha * bodyGlow * 0.6})`);
                    ctx.fillStyle = bodyGradient;
                    
                    // –†–∏—Å—É–µ–º 3D —Å–µ–≥–º–µ–Ω—Ç
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // –í–µ—Ä—Ö–Ω–∏–π –±–ª–∏–∫
                    const highlightGradient = ctx.createRadialGradient(
                        centerX - radius * 0.3, centerY - radius * 0.3, 0,
                        centerX - radius * 0.3, centerY - radius * 0.3, radius * 0.5
                    );
                    highlightGradient.addColorStop(0, `rgba(255, 255, 255, ${0.4 * intensity})`);
                    highlightGradient.addColorStop(1, 'rgba(0, 191, 255, 0)');
                    ctx.fillStyle = highlightGradient;
                    ctx.beginPath();
                    ctx.arc(centerX - radius * 0.3, centerY - radius * 0.3, radius * 0.5, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // –ì—Ä–∞–Ω–∏—Ü–∞
                    ctx.strokeStyle = `rgba(138, 43, 226, ${0.6 * bodyGlow})`;
                    ctx.lineWidth = 1.5;
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                    ctx.stroke();
                    
                    ctx.shadowBlur = 0;
                }
            });
        }

        function drawFood() {
            const x = food.x * gridSize;
            const y = food.y * gridSize;
            const size = gridSize - 2;
            const centerX = x + size / 2;
            const centerY = y + size / 2;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ –¥–ª—è —Å–≤–µ—á–µ–Ω–∏—è
            const time = Date.now() / 500;
            const pulse = Math.sin(time) * 0.3 + 0.7; // –û—Ç 0.4 –¥–æ 1.0
            const glowIntensity = 0.8 + pulse * 0.2; // –û—Ç 0.8 –¥–æ 1.0
            const rotation = (Date.now() / 2000) % (Math.PI * 2); // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∑–≤–µ–∑–¥—ã
            function drawStar(cx, cy, outerRadius, innerRadius, points, rotation) {
                ctx.beginPath();
                for (let i = 0; i < points * 2; i++) {
                    const angle = (i * Math.PI / points) + rotation;
                    const radius = i % 2 === 0 ? outerRadius : innerRadius;
                    const px = cx + Math.cos(angle) * radius;
                    const py = cy + Math.sin(angle) * radius;
                    if (i === 0) {
                        ctx.moveTo(px, py);
                    } else {
                        ctx.lineTo(px, py);
                    }
                }
                ctx.closePath();
            }
            
            const outerRadius = (size / 2 - 1) * glowIntensity;
            const innerRadius = outerRadius * 0.4;
            const points = 5;
            
            // –í–Ω–µ—à–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ (—Å–∞–º–æ–µ —è—Ä–∫–æ–µ)
            ctx.shadowColor = `rgba(255, 215, 0, ${0.9 * glowIntensity})`;
            ctx.shadowBlur = 20 * glowIntensity;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
            
            // –í–Ω–µ—à–Ω–∏–π —Å–ª–æ–π —Å–≤–µ—á–µ–Ω–∏—è
            drawStar(centerX, centerY, outerRadius + 4, innerRadius + 2, points, rotation);
            ctx.fillStyle = `rgba(255, 255, 200, ${0.5 * glowIntensity})`;
            ctx.fill();
            
            // –°—Ä–µ–¥–Ω–∏–π —Å–ª–æ–π —Å–≤–µ—á–µ–Ω–∏—è
            drawStar(centerX, centerY, outerRadius + 2, innerRadius + 1, points, rotation);
            ctx.fillStyle = `rgba(255, 255, 150, ${0.7 * glowIntensity})`;
            ctx.fill();
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∑–≤–µ–∑–¥–∞ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
            const starGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, outerRadius);
            starGradient.addColorStop(0, `rgba(255, 255, 100, ${glowIntensity})`);
            starGradient.addColorStop(0.5, `rgba(255, 215, 0, ${glowIntensity * 0.9})`);
            starGradient.addColorStop(1, `rgba(255, 165, 0, ${glowIntensity * 0.8})`);
            ctx.fillStyle = starGradient;
            
            drawStar(centerX, centerY, outerRadius, innerRadius, points, rotation);
            ctx.fill();
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ –∑–≤–µ–∑–¥—ã
            ctx.shadowColor = `rgba(255, 215, 0, ${0.8 * glowIntensity})`;
            ctx.shadowBlur = 25 * glowIntensity;
            ctx.fill();
            
            // –Ø—Ä–∫–æ–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–≤–µ—á–µ–Ω–∏–µ
            const innerGlow = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, outerRadius * 0.6);
            innerGlow.addColorStop(0, `rgba(255, 255, 255, ${0.9 * glowIntensity})`);
            innerGlow.addColorStop(0.5, `rgba(255, 255, 200, ${0.6 * glowIntensity})`);
            innerGlow.addColorStop(1, 'rgba(255, 215, 0, 0)');
            ctx.fillStyle = innerGlow;
            drawStar(centerX, centerY, outerRadius * 0.6, innerRadius * 0.6, points, rotation);
            ctx.fill();
            
            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –±–ª–∏–∫
            ctx.fillStyle = `rgba(255, 255, 255, ${glowIntensity})`;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 2, 0, Math.PI * 2);
            ctx.fill();
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –∑–≤–µ–∑–¥–æ—á–∫–∏ –≤–æ–∫—Ä—É–≥ (—ç—Ñ—Ñ–µ–∫—Ç –∏—Å–∫—Ä)
            const sparkleCount = 4;
            for (let i = 0; i < sparkleCount; i++) {
                const sparkleAngle = (i * Math.PI * 2 / sparkleCount) + rotation;
                const sparkleDist = outerRadius + 3;
                const sparkleX = centerX + Math.cos(sparkleAngle) * sparkleDist;
                const sparkleY = centerY + Math.sin(sparkleAngle) * sparkleDist;
                const sparkleSize = 1.5 * glowIntensity;
                
                ctx.fillStyle = `rgba(255, 255, 255, ${0.8 * glowIntensity})`;
                ctx.beginPath();
                ctx.arc(sparkleX, sparkleY, sparkleSize, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // –°–±—Ä–æ—Å —Ç–µ–Ω–µ–π
            ctx.shadowBlur = 0;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
        }

        function drawBombs() {
            bombs.forEach(bomb => {
                const x = bomb.x * gridSize;
                const y = bomb.y * gridSize;
                const size = gridSize - 2;
                const centerX = x + size / 2;
                const centerY = y + size / 2;
                
                // –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –¥–æ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –º–∏–≥–∞–Ω–∏—è
                const timeLeft = bomb.lifetime - (Date.now() - bomb.spawnTime);
                const blinkRate = Math.sin((bomb.lifetime - timeLeft) / bomb.lifetime * Math.PI * 8) * 0.3 + 0.7;
                
                // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –±–æ–º–±—ã
                const bombGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, size / 2);
                bombGradient.addColorStop(0, `rgba(33, 33, 33, ${blinkRate})`);
                bombGradient.addColorStop(0.5, `rgba(66, 66, 66, ${blinkRate})`);
                bombGradient.addColorStop(1, `rgba(0, 0, 0, ${blinkRate})`);
                ctx.fillStyle = bombGradient;
                
                // –†–∏—Å—É–µ–º –±–æ–º–±—É
                ctx.beginPath();
                ctx.arc(centerX, centerY, size / 2 - 1, 0, Math.PI * 2);
                ctx.fill();
                
                // –≠—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—á–µ–Ω–∏—è
                ctx.shadowColor = `rgba(255, 0, 0, ${blinkRate * 0.5})`;
                ctx.shadowBlur = 6;
                ctx.fill();
                ctx.shadowBlur = 0;
                
                // –§–∏—Ç–∏–ª—å –±–æ–º–±—ã
                ctx.fillStyle = `rgba(255, 200, 0, ${blinkRate})`;
                ctx.beginPath();
                ctx.arc(centerX, centerY - size / 3, 2, 0, Math.PI * 2);
                ctx.fill();
                
                // –ò—Å–∫—Ä—ã (–∫–æ–≥–¥–∞ –æ—Å—Ç–∞–ª–æ—Å—å –º–µ–Ω—å—à–µ 40% –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏)
                if (timeLeft < bomb.lifetime * 0.4) {
                    ctx.fillStyle = `rgba(255, 100, 0, ${blinkRate})`;
                    ctx.beginPath();
                    ctx.arc(centerX - 3, centerY - size / 3 - 2, 1.5, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.beginPath();
                    ctx.arc(centerX + 3, centerY - size / 3 - 2, 1.5, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
        }

        function moveSnake() {
            // –ù–µ –¥–≤–∏–≥–∞—Ç—å—Å—è, –µ—Å–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –∑–∞–¥–∞–Ω–æ
            if (dx === 0 && dy === 0) {
                return;
            }

            const head = {x: snake[0].x + dx, y: snake[0].y + dy};

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏
            if (head.x < 0 || head.x >= tileCountX || head.y < 0 || head.y >= tileCountY) {
                gameOver();
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å —Ç–µ–ª–æ–º (–ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–ª–æ, –Ω–µ –≥–æ–ª–æ–≤—É)
            for (let i = 0; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    gameOver();
                    return;
                }
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –±–æ–º–±–∞–º–∏
            for (let bomb of bombs) {
                if (head.x === bomb.x && head.y === bomb.y) {
                    gameOver();
                    return;
                }
            }

            snake.unshift(head);

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–µ–¥–∞–Ω–∏—è –µ–¥—ã
            if (head.x === food.x && head.y === food.y) {
                score++;
                scoreElement.textContent = score;
                randomFood();
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–º–± –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å—á–µ—Ç–∞
                updateBombSpawnInterval();
            } else {
                snake.pop();
            }
        }

        function gameOver() {
            gameRunning = false;
            finalScoreElement.textContent = score;
            gameOverElement.classList.add('show');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞
            if (titleElement) titleElement.classList.remove('hidden');
            
            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–º–±
            if (bombSpawnInterval) {
                clearInterval(bombSpawnInterval);
                bombSpawnInterval = null;
            }
        }

        function restartGame() {
            snake = [{x: Math.floor(tileCountX / 2), y: Math.floor(tileCountY / 2)}];
            bombs = [];
            dx = 0;
            dy = 0;
            score = 0;
            scoreElement.textContent = score;
            gameRunning = true;
            gameOverElement.classList.remove('show');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
            if (titleElement) titleElement.classList.remove('hidden');
            
            randomFood();
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
            if (bombSpawnInterval) {
                clearInterval(bombSpawnInterval);
            }
            
            // –ó–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–º–± (—Å —É—á–µ—Ç–æ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
            updateBombSpawnInterval();
            
            gameLoop();
        }

        function gameLoop() {
            if (!gameRunning) return;

            moveSnake();
            drawGame();

            // –°–∫–æ—Ä–æ—Å—Ç—å –∏–≥—Ä—ã –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—á–µ—Ç–∞
            const speed = getGameSpeed();
            setTimeout(gameLoop, speed);
        }

        const titleElement = document.querySelector('h1');

        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;

            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
            if (e.key === 'ArrowUp' && dy !== 1) {
                dx = 0;
                dy = -1;
                // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è
                if (titleElement) titleElement.classList.add('hidden');
            } else if (e.key === 'ArrowDown' && dy !== -1) {
                dx = 0;
                dy = 1;
                if (titleElement) titleElement.classList.add('hidden');
            } else if (e.key === 'ArrowLeft' && dx !== 1) {
                dx = -1;
                dy = 0;
                if (titleElement) titleElement.classList.add('hidden');
            } else if (e.key === 'ArrowRight' && dx !== -1) {
                dx = 1;
                dy = 0;
                if (titleElement) titleElement.classList.add('hidden');
            }
        });

        // –°–µ–Ω—Å–æ—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        const touchButtons = document.querySelectorAll('.d-pad-button[data-direction]');
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ –∫–Ω–æ–ø–∫–∏
        touchButtons.forEach(button => {
            const direction = button.getAttribute('data-direction');
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –º—ã—à–∏/—Ç–∞—á–∞
            button.addEventListener('touchstart', (e) => {
                e.preventDefault();
                handleDirection(direction);
            });
            
            button.addEventListener('mousedown', (e) => {
                e.preventDefault();
                handleDirection(direction);
            });
            
            // –û—Ç–ø—É—Å–∫–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
            button.addEventListener('touchend', (e) => {
                e.preventDefault();
            });
            
            button.addEventListener('mouseup', (e) => {
                e.preventDefault();
            });
        });

        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function handleDirection(direction) {
            if (!gameRunning) return;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ–≥–¥–∞ –∏–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è
            if (titleElement) titleElement.classList.add('hidden');
            
            switch(direction) {
                case 'up':
                    if (dy !== 1) {
                        dx = 0;
                        dy = -1;
                    }
                    break;
                case 'down':
                    if (dy !== -1) {
                        dx = 0;
                        dy = 1;
                    }
                    break;
                case 'left':
                    if (dx !== 1) {
                        dx = -1;
                        dy = 0;
                    }
                    break;
                case 'right':
                    if (dx !== -1) {
                        dx = 1;
                        dy = 0;
                    }
                    break;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–≤–∞–π–ø–æ–≤ (–∂–µ—Å—Ç—ã)
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            touchStartX = touch.clientX;
            touchStartY = touch.clientY;
        }, { passive: false });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            if (!gameRunning) return;
            
            const touch = e.changedTouches[0];
            touchEndX = touch.clientX;
            touchEndY = touch.clientY;
            
            handleSwipe();
        }, { passive: false });

        function handleSwipe() {
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            const minSwipeDistance = 30; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Å–≤–∞–π–ø–∞
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                if (Math.abs(deltaX) > minSwipeDistance) {
                    if (deltaX > 0 && dx !== -1) {
                        // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ
                        dx = 1;
                        dy = 0;
                        if (titleElement) titleElement.classList.add('hidden');
                    } else if (deltaX < 0 && dx !== 1) {
                        // –°–≤–∞–π–ø –≤–ª–µ–≤–æ
                        dx = -1;
                        dy = 0;
                        if (titleElement) titleElement.classList.add('hidden');
                    }
                }
            } else {
                // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                if (Math.abs(deltaY) > minSwipeDistance) {
                    if (deltaY > 0 && dy !== -1) {
                        // –°–≤–∞–π–ø –≤–Ω–∏–∑
                        dx = 0;
                        dy = 1;
                        if (titleElement) titleElement.classList.add('hidden');
                    } else if (deltaY < 0 && dy !== 1) {
                        // –°–≤–∞–π–ø –≤–≤–µ—Ä—Ö
                        dx = 0;
                        dy = -1;
                        if (titleElement) titleElement.classList.add('hidden');
                    }
                }
            }
        }

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ —Å–≤–∞–π–ø–∞—Ö
        document.addEventListener('touchmove', (e) => {
            if (e.target === canvas || e.target.closest('.d-pad')) {
                e.preventDefault();
            }
        }, { passive: false });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        randomFood();
        
        // –ó–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–º–± (—Å —É—á–µ—Ç–æ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
        updateBombSpawnInterval();
        
        gameLoop();
    </script>
</body>
</html>
